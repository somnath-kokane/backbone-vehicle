/*! backbone.search - v0.1.0-pre - 2012-12-24
* https://github.com/boazsender/backbone.search
* Copyright (c) 2012 Boaz Sender; Licensed MIT */
(function(a,b,c,d){a.Collection.prototype.search=function(d){d=c.trim(d.toLowerCase());var e=new a.Collection;return e.comparator=function(a){return-1*a.get("searchscore")},d&&this.each(function(a){var c=JSON.stringify(b.values(a.toJSON())).toLowerCase().score(d);c>0&&(a.set("searchscore",c),e.add(a))}),e},String.prototype.score=function(a){if(a.length===0)return.9;if(a.length>this.length)return 0;for(var b=a.length;b>0;b--){var c=a.substring(0,b),d=this.indexOf(c);if(d<0)continue;if(d+a.length>this.length)continue;var e=this.substring(d+c.length),f=null;b>=a.length?f="":f=a.substring(b);var g=e.score(f,d);if(g>0){var h=this.length-e.length;if(d!==0){var i=0,j=this.charCodeAt(d-1);if(j===32||j===9)for(i=d-2;i>=0;i--)j=this.charCodeAt(i),h-=j===32||j===9?1:.15;else h-=d}return h+=g*e.length,h/=this.length,h}}return 0}})(Backbone,_,jQuery);